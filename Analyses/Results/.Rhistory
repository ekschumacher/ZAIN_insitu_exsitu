library(adegenet)
library(diveRsity)
library(poppr)
library(hierfstat)
library(Demerelate)
###################################
#        Load in data files       #
###################################
##set working directory
setwd("../Data_Files")
#load in genind
ZAIN_allpop_gen <- read.genepop("ZAIN_adegenet_files/ZAIN_allpop.gen", ncode = 3)
library(diveRsity)
###############################
#     Scoring Comparison      #
###############################
#convert arp2gen
arp2gen("ZAIN_adegenet_files/ZAIN_garden_wild.arp")
###############################
#     Scoring Comparison      #
###############################
#convert arp2gen
arp2gen("ZAIN_adegenet_files/ZAIN_garden_wild.arp")
#three pop genind and genpop files
ZAIN_garden_wild_gen <- read.genepop("ZAIN_garden_wild.gen", ncode = 3)
#three pop genind and genpop files
ZAIN_garden_wild_gen <- read.genepop("ZAIN_adegenet_files/ZAIN_garden_wild.gen", ncode = 3)
ZAIN_garden_wild_pop <- genind2genpop(ZAIN_garden_wild_gen)
#load in garden/wild data frame
ZAIN_garden_wild_df <- read.csv("ZAIN_data_frames/ZAIN_allpop_df.csv")
colnames(ZAIN_garden_wild_df)
#create a list of loci
loci <- colnames(ZAIN_garden_wild_df)
length(loci)
gsub("\\..*","",loci)
unique(gsub("\\..*","",loci)[4:25])
length(unique(gsub("\\..*","",loci)[4:25]))
#clean list
loci <- unique(gsub("\\..*","",loci)[4:25])
colnames(ZAIN_garden_wild_gen@tab)
#load in data frame with 2 pops - scored by us vs. scored by patrick
ZAIN_garden_wild_gen <- read.genepop("ZAIN_adegenet_files/ZAIN_garden_wild.gen", ncode = 3)
colnames(ZAIN_garden_wild_gen@tab)
#load in data frame with 2 pops - scored by us vs. scored by patrick
ZAIN_garden_wild_gen <- read.genepop("ZAIN_adegenet_files/ZAIN_garden_wild.gen", ncode = 3)
#convert to genpop
ZAIN_garden_wild_pop <- genind2genpop(ZAIN_garden_wild_gen)
colnames(ZAIN_garden_wild_pop@tab)
loci
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
#for(p in 1:3) butternut_3pop_scoring[p,]<-butternut_3pop_scoring[p,]/sum(butternut_3pop_scoring[p,])
# butternut_3pop_scoring_barplot <- barplot(butternut_3pop_scoring, las = 2, beside = TRUE, col = c("firebrick4","firebrick2","dodgerblue"), legend.text =  c("Canada_Sean", "Canada_Jean","United States"), ylim = c(0,1), main = paste0(a))
}
ZAIN_scoring
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,]<-ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
# butternut_3pop_scoring_barplot <- barplot(butternut_3pop_scoring, las = 2, beside = TRUE, col = c("firebrick4","firebrick2","dodgerblue"), legend.text =  c("Canada_Sean", "Canada_Jean","United States"), ylim = c(0,1), main = paste0(a))
}
ZAIN_scoring
##loop to compare scoring between the Hoban Lab Scoring and the Griffith Lab
setwd("../Analyses/Results")
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,]<-ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
ZAIN_barplot <- barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"), legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
order(ZAIN_scoring)
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,]<-ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
ZAIN_barplot <- barplot(order(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"), legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
?barplot
sort(barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"), legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a)))
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,]<-ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
ZAIN_barplot <- sort(barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a)))
}
dev.off()
barplot(sort(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
as.factor(ZAIN_scoring)
ZAIN_scoring
sort(ZAIN_scoring)
sort(colnames(ZAIN_scoring))
ZAIN_barplot <- barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
labels = sort(colnames(ZAIN_scoring)),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
ZAIN_barplot <- barplot(sort(colnames(ZAIN_scoring)), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
labels = sort(colnames(ZAIN_scoring)),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
ZAIN_barplot <- barplot(order(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
#format data frame
ZAIN_scoring <- ZAIN_scoring[order(colnames(ZAIN_scoring),decreasing = TRUE),]
ZAIN_scoring
order(ZAIN_scoring)
order(colnames(ZAIN_scoring))
sort(colnames(ZAIN_scoring))
ZAIN_scoring{sort(colnames(ZAIN_scoring))}
ZAIN_scoring[sort(colnames(ZAIN_scoring))]
sort(colnames(ZAIN_scoring))
ZAIN_scoring
ZAIN_scoring[sort(colnames(ZAIN_scoring))]
colnames(ZAIN_scoring0[sort(colnames(ZAIN_scoring))]
)
colnames(ZAIN_scoring)[sort(colnames(ZAIN_scoring))]
ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#now plot
ZAIN_barplot <- barplot(order(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#now plot
# ZAIN_barplot <- barplot(order(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
#                          legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
ZAIN_scoring
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#now plot
ZAIN_barplot <- barplot(order(ZAIN_scoring), las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
ZAIN_scoring
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
for(a in loci){
ZAIN_scoring <- ZAIN_garden_wild_pop[,which(grepl(a,colnames(ZAIN_garden_wild_pop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#now plot
ZAIN_barplot <- barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("Hoban_Lab","Griffith_Lab"), ylim = c(0,1), main = paste0(a))
}
dev.off()
library(adegenet)
library(diveRsity)
#load in data frame with 2 pops - scored by us vs. scored by patrick
ZAIN_garden_wild_gen <- read.genepop("ZAIN_adegenet_files/ZAIN_garden_wild.gen", ncode = 3)
#convert to genpop
ZAIN_garden_wild_pop <- genind2genpop(ZAIN_garden_wild_gen)
#load in garden/wild data frame
ZAIN_garden_wild_df <- read.csv("ZAIN_data_frames/ZAIN_allpop_df.csv")
#create a list of loci
loci <- colnames(ZAIN_garden_wild_df)
#clean list
loci <- unique(gsub("\\..*","",loci)[4:25])
